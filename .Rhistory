knitr::opts_chunk$set( message=F, warning=F, fig.width = 10, fig.height = 10 )
dir()
dir()
getwd()
setwd("\\ignacio")
setwd("\ignacio")
setwd("/ignacio")
setwd("\.ignacio")
setwd(".\ignacio")
setwd(".\\ignacio")
dir()
dat <- read.csv("Data_Feed.csv")
View(dat)
str(dat)
dat <- read.csv("Data_Feed.csv", stringsAsFactors = F)
str(dat)
colnames(dat)
list(colnames(dat))
stack(colnames(dat))
stack(colnames(dat))
colnames(dat)
colnames(dat)
stack(colnames(dat))
cat(colnames(dat), sep="\n"))
cat(colnames(dat), sep="\n")
str(dat)
unique(dat$transaction_status)
View(dat)
dir()
cnt <- read.csv("NYcontracts.csv", stringsAsFactors = F)
grn <- read.csv("NYgrants.csv", stringsAsFactors = F)
rm(dat)
str(cnt)
unique(dat$maj_agency_cat)
unique(cat$maj_agency_cat)
unique(cnt$maj_agency_cat)
unique(cnt$maj_agency_cat)
cat(unique(cnt$maj_agency_cat), sep="\n") #to print a list.
dir()
getwd()
library(dplyr)
str(cnt) %>% pander
unique(cnt$fundedbyforeignentity)
cat(unique(cnt$maj_agency_cat), sep="\n") #to print a list.
cat(unique(cnt$descriptionofcontractrequirement), sep="\n") #to print a list.
unique(unique(cnt$descriptionofcontractrequirement)
```
unique(cnt$descriptionofcontractrequirement)
cat(unique(cnt$descriptionofcontractrequirement), sep="\n") #to print a list.
View(grn)
View(cnt)
dat <- cnt[,dollarsobligated]
dat <- cnt[,"dollarsobligated"]
dat
dat <- cnt[,"dollarsobligated" & "maj_agency_cat" & "contractactiontype" & "vendorname" & "productorservicecode" & "principalnaicscode"]
dat <- cnt[,c("dollarsobligated", "maj_agency_cat", "contractactiontype", "vendorname", "productorservicecode", "principalnaicscode")]
colnames(dat)
library(dplyr)
group_by(dat, vendorname)
ven <- group_by(dat, vendorname)
ven <- group_by(dat, vendorname)
summarize(ven, sum(dollarsobligated))
pie(ven)
ven <- group_by(dat, vendorname)
ven <- summarize(ven, sum(dollarsobligated))
pie(ven)
View(ven)
plot(ven)
barplot(ven)
ven <- group_by(dat, vendorname)
str(ven)
View(ven)
View(grn)
ven <- group_by(dat, vendorname)
ven <- summarize(ven, sum(dollarsobligated))
ven <- group_by(dat, vendorname)
ven <- summarize(ven, Monies = sum(dollarsobligated))
x <- ven$Monies < 0
x
ven$Monies[x] <- NA
pie(ven)
ven <- group_by(dat, vendorname)
ven <- summarize(ven, Monies = sum(dollarsobligated))
x <- ven$Monies < 0
ven$Monies[!x] <- NA
pie(ven)
ven <- group_by(dat, vendorname)
ven <- summarize(ven, Monies = sum(dollarsobligated))
x
ven
x <- ven$Monies < 0
ven$Monies[x]
ven$Monies[x] <- NA
pie(ven)
x <- ven$Monies < 0
table(x)
ven <- group_by(dat, vendorname)
ven <- summarize(ven, Monies = sum(dollarsobligated))
x <- ven$Monies < 0
ven$Monies[x] <- NA
pie(ven)
barplot(ven)
ven
barplot(ven$Monies)
arrange(ven, Monies)
arrange(ven, desc(Monies))
barplot(ven$Monies)
ven <- arrange(ven, desc(Monies))
barplot(ven$Monies)
ven
View(ven)
psc <- group_by(dat, productorservicecode)
psc <- summarize(ven, Monies = sum(dollarsobligated))
x <- psc$Monies < 0
psc$Monies[x] <- NA
psc <- arrange(psc, desc(Monies))
psc <- group_by(dat, productorservicecode)
psc <- summarize(ven, Monies = sum(dollarsobligated))
psc <- group_by(dat, productorservicecode)
psc <- summarize(psc, Monies = sum(dollarsobligated))
x <- psc$Monies < 0
psc$Monies[x] <- NA
head(psc)
psc <- arrange(psc, desc(Monies))
psc
barplot(psc$Monies)
psc
ven
psc
nai <- group_by(dat, principalnaicscode)
nai <- summarize(nai, Monies = sum(dollarsobligated))
x <- nai$Monies < 0
nai$Monies[x] <- NA
nai <- arrange(nai, desc(Monies))
nai
barplot(nai$Monies)
dir()
nai
dir()
str(dat)
dir()
naics <- read.csv("NAICS_cat.csv")
naics
nai$NAICS <- substring(nai$principalnaicscode, 1,2)
nai
naics
nai$NAICS
nai$NAICS <- as.integer(substring(nai$principalnaicscode, 1,2))
nai$NAICS
naics
nai$NAICS <-
match(nai$NAICS, naics$X2017.NAICS.Code)
nai$NAICS <-
x <- match(nai$NAICS, naics$X2017.NAICS.Code)
x
nai$NAICS,
nai$NAICS
nai$NAICS
naics <- read.csv("NAICS_cat.csv")
nai
nai <- group_by(dat, principalnaicscode)
nai <- summarize(nai, Monies = sum(dollarsobligated))
x <- nai$Monies < 0
nai$Monies[x] <- NA
nai <- arrange(nai, desc(Monies))
nai
colname(nai)[1] <- NAICS
colname(nai)[1] <- "NAICS"
colname(nai)[1]
colnames(nai)[1]
colnames(nai)[1] <- "NAICS"
colnames(nai)[1]
nai$NAICS <- as.integer(substring(nai$NAICS, 1,2))
nai$NAICS
naics <- read.csv("NAICS_cat.csv")
x <- match(nai$NAICS, naics$X2017.NAICS.Code)
x
nai$NAICS.name <- naics$X2017.NAICS.Code[x]
nai
nai$NAICS.name <- naics$X2017.NAICS.Title[x]
nai
nai <- nai[,c(1,3,2)]
nai
nai <- group_by(dat, principalnaicscode)
nai <- summarize(nai, Monies = sum(dollarsobligated))
x <- nai$Monies < 0
nai$Monies[x] <- NA
nai <- arrange(nai, desc(Monies))
nai
nai <- group_by(dat, principalnaicscode)
nai <- dat
nai <- dat
nai
nai <- dat
nai$NAICS <- as.integer(substring(nai$principalnaicscode, 1,2))
nai$NAICS
naics <- read.csv("NAICS_cat.csv")
x <- match(nai$NAICS, naics$X2017.NAICS.Code)
nai <- dat
nai$NAICS.code <- as.integer(substring(nai$principalnaicscode, 1,2))
naics <- read.csv("NAICS_cat.csv")
x <- match(nai$NAICS.code, naics$X2017.NAICS.Code)
nai$NAICS.name <- naics$X2017.NAICS.Title[x]
nai <- group_by(dat, NAICS.code)
nai <- summarize(nai, Monies = sum(dollarsobligated))
x <- nai$Monies < 0
nai$Monies[x] <- NA
nai <- arrange(nai, desc(Monies))
colnames(nai)
nai
nai <- dat
nai$NAICS.code <- as.integer(substring(nai$principalnaicscode, 1,2))
nai
naics <- read.csv("NAICS_cat.csv")
x <- match(nai$NAICS.code, naics$X2017.NAICS.Code)
nai$NAICS.name <- naics$X2017.NAICS.Title[x]
nai
nai <- group_by(dat, NAICS.name)
nai <- group_by(nai, NAICS.name)
nai
nai <- summarize(nai, Monies = sum(dollarsobligated))
nai
x <- nai$Monies < 0
nai$Monies[x] <- NA
nai <- arrange(nai, desc(Monies))
nai
options(scipen=999)
nai
barplot(nai$Monies)
nai
psc %>% pander
knitr::opts_chunk$set( message=F, warning=F, fig.width = 10, fig.height = 10 )
library(dplyr)
library(pander)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
cnt <- read.csv("NYcontracts.csv", stringsAsFactors = F)
#making naics code two digit
cnt$NAICS.code <- as.integer(substring(cnt$principalnaicscode, 1,2))
#adding the name variable
naics <- read.csv("NAICS_cat.csv")
x <- match(cnt$NAICS.code, naics$X2017.NAICS.Code)
cnt$NAICS.name <- as.character(naics$X2017.NAICS.Title[x])
x <- cnt$NAICS.name == "Manufacturing"
man <- cnt[x, c("dollarsobligated", "maj_agency_cat", "contractactiontype", "vendorname", "productorservicecode", "NAICS.name")]
x <- is.na(man$dollarsobligated)
sum(man$dollarsobligated[!x], na.rm = T)
length(man$dollarsobligated[!x])
psc %>% pander
x <- is.na(man$dollarsobligated)
sum(man$dollarsobligated[!x], na.rm = T)
length(man$dollarsobligated[!x])
man %>% pander
sort(unique(cnt$maj_agency_cat))
x <- cnt$NAICS.name == "Manufacturing"
man <- cnt[x, c("dollarsobligated", "maj_agency_cat", "contractactiontype", "vendorname", "productorservicecode", "NAICS.name")]
table(cnt$maj_agency_cat)
as.dataframe(table(cnt$maj_agency_cat))
as.data.frame(table(cnt$maj_agency_cat))
arrange(as.data.frame(table(cnt$maj_agency_cat)), Freq)
arrange(as.data.frame(table(cnt$maj_agency_cat)), desc(Freq))
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
cnt <- read.csv("NYcontracts.csv", stringsAsFactors = F)
x <- colnames(cnt) =="type"
table(x <- colnames(cnt) =="type")
table(x <- colnames(cnt) =="contracttype")
table(x <- colnames(cnt) =="contractactiontype")
colnames(cnt)
cnt$transaction_status
knitr::opts_chunk$set( message=F, warning=F, fig.width = 10, fig.height = 10 )
library(dplyr)
library(pander)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
url <- "https://api.usaspending.gov/"
path <- "api/v1/accounts/awards/"
knitr::opts_chunk$set( message=F, warning=F, fig.width = 10, fig.height = 10 )
library(dplyr)
library(pander)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
url <- "https://api.usaspending.gov/"
path <- "api/v1/accounts/awards/"
raw.result <- GET(   url = url
, path = path
)
library( httr )
library( jsonlite )
library( lubridate )
library( rgdal )
install.packages( lubridate )
install.packages( "lubridate" )
library( lubridate)
raw.result <- GET(   url = url
, path = path
)
raw.result
raw.result
class(raw.result)
raw <- GET(   url = url, path = path)
raw$url
raw$content
head(raw$content)
class(raw$content)
txt <- rawToChar(raw$content)
txt
txt <- fromJSON(txt)
txt
txt
txt[1]
txt[2]
txt[3]
class(txt[3])
txt <- as.data.frame(txt[3], stringsAsFactors = F)
txt
View(txt)
knitr::opts_chunk$set( message=F, warning=F, fig.width = 10, fig.height = 10 )
library(dplyr)
library(pander)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
cnt <- read.csv("NYcontracts.csv", stringsAsFactors = F)
cnt$transaction_status
#making naics code two digit
cnt$NAICS.code <- as.integer(substring(cnt$principalnaicscode, 1,2))
#adding the name variable
naics <- read.csv("NAICS_cat.csv")
x <- match(cnt$NAICS.code, naics$X2017.NAICS.Code)
cnt$NAICS.name <- as.character(naics$X2017.NAICS.Title[x])
x <- cnt$NAICS.name == "Construction"
man <- cnt[x, c("piid", "dollarsobligated", "contractactiontype", "productorservicecode", "psc_cat",
"pop_state_code", "placeofperformancecity",
"competitiveprocedures", "multiyearcontract", "multipleorsingleawardidc",
"maj_agency_cat",
"vendorname", "NAICS.name", "receivescontracts", "receivesgrants", "receivescontractsandgrants",
"annualrevenue", "numberofemployees", "isconstructionfirm")]
man
x <- is.na(man$dollarsobligated)
sum(man$dollarsobligated[!x], na.rm = T)
length(man$dollarsobligated[!x])
arrange(as.data.frame(table(cnt$maj_agency_cat)), desc(Freq))
arrange(as.data.frame(table(cnt$maj_agency_cat)), desc(Freq))[1:5]
arrange(as.data.frame(table(cnt$maj_agency_cat)), desc(Freq))
arrange(as.data.frame(table(cnt$maj_agency_cat)), desc(Freq))[c(1:5),]
arrange(as.data.frame(table(cnt$productorservicecode)), desc(Freq))[c(1:5),]
arrange(as.data.frame(table(cnt$psc_cat)), desc(Freq))[c(1:5),]
arrange(as.data.frame(table(cnt$vendorname)), desc(Freq))[c(1:5),]
x <- cnt$vendorname == "HENRY SCHEIN, INC." & cnt$NAICS.name == "Construction"
x <- cnt$vendorname == "HENRY SCHEIN, INC." & cnt$NAICS.name == "Construction"
con.henry <- cnt[x, c("maj_agency_cat", "dollarsobligated", "contractactiontype", "vendorname", "dunsnumber", "NAICS.name", "productorservicecode")]
x <- cnt$NAICS.name == "Construction"
con <- cnt[x, c("piid", "dollarsobligated", "contractactiontype", "productorservicecode", "psc_cat",
"pop_state_code", "placeofperformancecity",
"competitiveprocedures", "multiyearcontract", "multipleorsingleawardidc",
"maj_agency_cat",
"vendorname", "NAICS.name", "receivescontracts", "receivesgrants", "receivescontractsandgrants",
"annualrevenue", "numberofemployees", "isconstructionfirm")]
x <- is.na(con$dollarsobligated)
sum(con$dollarsobligated[!x], na.rm = T)
length(con$dollarsobligated[!x])
arrange(as.data.frame(table(con$maj_agency_cat)), desc(Freq))[c(1:5),]
arrange(as.data.frame(table(con$productorservicecode)), desc(Freq))[c(1:5),]
arrange(as.data.frame(table(con$psc_cat)), desc(Freq))[c(1:5),] #better to use this code!
arrange(as.data.frame(table(con$vendorname)), desc(Freq))[c(1:5),]
con.grp <- group_by(con, vendorname)
con.grp <- summarize(con, Monies = sum(dollarsobligated), Freq = n())
con.grp
con.grp <- group_by(con, vendorname)
con.grp
con.grp <- summarize(con, Monies = sum(dollarsobligated), Freq = n())
con.grp
con
View(con)
unique(con$vendorname)
con.grp <- group_by(con, vendorname)
con.grp <- summarize(con.grp, Monies = sum(dollarsobligated), Freq = n())
con.grp
con.grp <- arrange(summarize(con.grp, Monies = sum(dollarsobligated), Freq = n()), desc(Monies))
con.grp <- group_by(con, vendorname)
con.grp <- arrange(summarize(con.grp, Monies = sum(dollarsobligated), Freq = n()), desc(Monies))
con.grp
x <- cnt$vendorname == "TRIO ASBESTOS REMOVAL CORP." & cnt$NAICS.name == "Construction"
con2 <- cnt[x, c("piid", "maj_agency_cat", "dollarsobligated",
"contractactiontype", "productorservicecode", "psc_cat",
"pop_state_code", "placeofperformancecity",
"competitiveprocedures", "multiyearcontract", "multipleorsingleawardidc",
"vendorname", "NAICS.name", "receivescontracts", "receivesgrants",
"receivescontractsandgrants", "annualrevenue", "numberofemployees", "isconstructionfirm")]
unique(con2$productorservicecode)
length(unique(con2$vendorname))
View(con2)
class(cnt$isconstructionfirm)
head(cnt$isconstructionfirm)
table(cnt$isconstructionfirm)
table
head(cnt$isconstructionfirm)
table(as.character(cnt$isconstructionfirm))
as.character(cnt$isconstructionfirm)
table(as.character(cnt$isconstructionfirm))
unique(as.character(cnt$isconstructionfirm))
library(dplyr)
library(pander)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston/Data-Capstone/ignacio")
cnt <- read.csv("./Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".//Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".///Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv("/Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".//Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".\\Data\\NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".\Data\NYcon2017", stringsAsFactors = F)
cnt <- read.csv(".\\\Data\\NYcon2017", stringsAsFactors = F)
cnt <- read.csv("\.\\Data\\NYcon2017", stringsAsFactors = F)
cnt <- read.csv("\\.\\Data\\NYcon2017", stringsAsFactors = F)
cnt <- read.csv("./Data/NYcon2017", stringsAsFactors = F)
cnt <- read.csv("./Data/NYcon2017.csv", stringsAsFactors = F)
cnt$NAICS.code <- as.integer(substring(cnt$principalnaicscode, 1,2))
naics <- read.csv("NAICS_cat.csv")
x <- match(cnt$NAICS.code, naics$X2017.NAICS.Code)
cnt$NAICS.name <- as.character(naics$X2017.NAICS.Title[x])
gra <- read.csv("./Data/NYgra2017.csv", stringsAsFactors = F)
x <- gra[1,]
x <- as.data.frame(lapply(x, class))
x <- as.data.frame(t(x))
x <- data.frame(var = row.names(x), class = as.character(x$V1), stringsAsFactors = F)
grav <- x
write.csv(grav, "gra.variables.csv", row.names = F)
unique(gra$cfda_program_num)
unique(gra$cfda_program_title	character)
unique(gra$cfda_program_title)
head(unique(gra$cfda_program_title))
head(table(gra$cfda_program_title))
(table(gra$cfda_program_title == "Abandoned Infants"))
(table(gra$cfda_program_title == ""))
table(gra$fda_program_num)
unique(gra$fda_program_num)
gra$fda_program_num
unique(gra$cfda_program_num)
is.na(gra$cfda_program_num)
table(is.na(gra$cfda_program_num)))
table(is.na(gra$cfda_program_num))
(table(gra$cfda_program_num == ""))
class(gra$cfda_program_title)
class(gra$cfda_program_num)
table(is.na(gra$cfda_program_title)) #no NAs here!
unique(fra$project_description)
unique(gra$project_description)
unique(gra$principal_place_cc)
sort(unique(gra$principal_place_cc))
sort(unique(gra$principal_place_state))
sort(unique(gra$recipient_state_code))
sort(unique(gra$recipient_city_name))
sort(unique(gra$recipient_county_code))
sort(unique(gra$recipient_county_name))
sort(unique(gra$recipient_state_code))
sort(unique(gra$recipient_city_name))
X <- gra$recipient_city_name == "Syracuse" | "SYRACUSE"
X <- gra$recipient_city_name %in% "Syracuse" | "SYRACUSE"
X <- gra$recipient_city_name %in% c("Syracuse", "SYRACUSE")
head(federal_award_id)
head(gra$unique_transaction_id)
head(gra$federal_award_id)
head(asst_cat_type)
head(gra$asst_cat_type)
head(gra$assistance_type)
gra$recipient_state_code
head(gra$exec1_fullname)
table(gra$exec1_fullname)
syr <- gra[x,c("maj_agency_cat",
"cfda_program_num", "cfda_program_title", "fed_funding_amount", "non_fed_funding_amount",
"total_funding_amount",	"asst_cat_type", "assistance_type", "record_type",
"fiscal_year", "principal_place_cc", "project_description", "recipient_name",
"recipient_type", "recip_cat_type", "recipient_city_name", "recipient_county_name",
"recipient_state_code", "exec1_fullname", "exec1_amount")]
X <- gra$recipient_city_name %in% c("Syracuse", "SYRACUSE")
syr <- gra[x,c("maj_agency_cat",
"cfda_program_num", "cfda_program_title", "fed_funding_amount", "non_fed_funding_amount",
"total_funding_amount",	"asst_cat_type", "assistance_type", "record_type",
"fiscal_year", "principal_place_cc", "project_description", "recipient_name",
"recipient_type", "recip_cat_type", "recipient_city_name", "recipient_county_name",
"recipient_state_code", "exec1_fullname", "exec1_amount")]
syr <- gra[x,)]
syr <- gra[x,]
gra
x <- gra$recipient_city_name %in% c("Syracuse", "SYRACUSE")
syr <- gra[x,c("maj_agency_cat",
"cfda_program_num", "cfda_program_title", "fed_funding_amount", "non_fed_funding_amount",
"total_funding_amount",	"asst_cat_type", "assistance_type", "record_type",
"fiscal_year", "principal_place_cc", "project_description", "recipient_name",
"recipient_type", "recip_cat_type", "recipient_city_name", "recipient_county_name",
"recipient_state_code", "exec1_fullname", "exec1_amount")]
syr
View(syr)
gra17 <- read.csv("./Data/NYgra2017.csv", stringsAsFactors = F)
gra16 <- read.csv("./Data/NYgra2016.csv", stringsAsFactors = F)
gra15 <- read.csv("./Data/NYgra2015.csv", stringsAsFactors = F)
gra14 <- read.csv("./Data/NYgra2014.csv", stringsAsFactors = F)
gra14 <- read.csv("./Data/NYgra2014.csv", stringsAsFactors = F)
dim(gra17)
dim(gra16)
dim(gra15)
dim(gra14)
table(colnames(gra17) == colnames(gra16))
table(colnames(gra16) == colnames(gra15))
table(colnames(gra14) == colnames(gra15))
x <- gra17$recipient_city_name %in% c("Syracuse", "SYRACUSE")
syr17 <- gra17[x,c("maj_agency_cat",
"cfda_program_num", "cfda_program_title", "fed_funding_amount", "non_fed_funding_amount",
"total_funding_amount",	"asst_cat_type", "assistance_type", "record_type",
"fiscal_year", "principal_place_cc", "project_description", "recipient_name",
"recipient_type", "recip_cat_type", "recipient_city_name", "recipient_county_name",
"recipient_state_code", "exec1_fullname", "exec1_amount")]
