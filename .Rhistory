<<<<<<< HEAD
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
bar.pov <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
bar.pov
krzycensuz <- function (x)
{
# Load Required Packages
require(ggplot2)
require(gridExtra)
options(scipen = 999)
#the function will make three plots, save them into objects and stack them together using gridExtra
#making the first plot
bar.pop <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
#theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#second plot
bar.inc <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=55276, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=55276, y="Median Income", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$MHincome, y="Median Income"), stat="identity", shape = 23, size = 8) +
#theme_bw() +
xlim(34200,max(x$MHincome)+800) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#third plot
bar.pov <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#making a legend with a plot.
leg <- ggplot(x, aes(fill=county.name)) +
geom_point(aes(x=2:(length(levels(x$county.name))+1), y=""), stat="identity", shape = 23, size = 8) +
theme_bw() +
coord_cartesian(xlim = 1:(length(levels(x$county.name))+2)) +
geom_text(aes(x=2:(length(levels(x$county.name))+1), y=.8, label = paste0(levels(x$county.name))),
size= 4,
hjust = .5,
vjust = .5,
colour = "grey20") +
labs(caption = "*Poverty Rate is a percentage; Median Income is by Household \n Source: ACS 2015 Census data.") +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
krzycensuz <- function (x)
{
# Load Required Packages
require(ggplot2)
require(gridExtra)
options(scipen = 999)
#the function will make three plots, save them into objects and stack them together using gridExtra
#making the first plot
bar.pop <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#second plot
bar.inc <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=55276, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=55276, y="Median Income", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$MHincome, y="Median Income"), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(34200,max(x$MHincome)+800) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#third plot
bar.pov <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#making a legend with a plot.
leg <- ggplot(x, aes(fill=county.name)) +
geom_point(aes(x=2:(length(levels(x$county.name))+1), y=""), stat="identity", shape = 23, size = 8) +
theme_minimal() +
coord_cartesian(xlim = 1:(length(levels(x$county.name))+2)) +
geom_text(aes(x=2:(length(levels(x$county.name))+1), y=.8, label = paste0(levels(x$county.name))),
size= 4,
hjust = .5,
vjust = .5,
colour = "grey20") +
labs(caption = "*Poverty Rate is a percentage; Median Income is by Household \n Source: ACS 2015 Census data.") +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
bar.pop <- ggplot(x, aes(fill=county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), color = "white", stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
bar.pop
bar.pop <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
bar.pop
krzycensuz <- function (x)
{
# Load Required Packages
require(ggplot2)
require(gridExtra)
options(scipen = 999)
#the function will make three plots, save them into objects and stack them together using gridExtra
#making the first plot
bar.pop <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#second plot
bar.inc <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=55276, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=55276, y="Median Income", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$MHincome, y="Median Income"), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(34200,max(x$MHincome)+800) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#third plot
bar.pov <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#making a legend with a plot.
leg <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_point(aes(x=2:(length(levels(x$county.name))+1), y=""), stat="identity", shape = 23, size = 8) +
theme_minimal() +
coord_cartesian(xlim = 1:(length(levels(x$county.name))+2)) +
geom_text(aes(x=2:(length(levels(x$county.name))+1), y=.8, label = paste0(levels(x$county.name))),
size= 4,
hjust = .5,
vjust = .5,
colour = "grey20") +
labs(caption = "*Poverty Rate is a percentage; Median Income is by Household \n Source: ACS 2015 Census data.") +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
krzycensuz <- function (x)
{
# Load Required Packages
require(ggplot2)
require(gridExtra)
options(scipen = 999)
#the function will make three plots, save them into objects and stack them together using gridExtra
#making the first plot
bar.pop <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#second plot
bar.inc <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=55276, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=55276, y="Median Income", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$MHincome, y="Median Income"), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(34200,max(x$MHincome)+800) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#third plot
bar.pov <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#making a legend with a plot.
leg <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_point(aes(x=2:(length(levels(x$county.name))+1), y=""), stat="identity", shape = 23, size = 8) +
theme_minimal() +
coord_cartesian(xlim = 1:(length(levels(x$county.name))+2)) +
geom_text(aes(x=2:(length(levels(x$county.name))+1), y=.7, label = paste0(levels(x$county.name))),
size= 4,
hjust = .5,
vjust = .5,
colour = "grey20") +
labs(caption = "*Poverty Rate is a percentage; Median Income is by Household \n Source: ACS 2015 Census data.") +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
krzycensuz <- function (x)
{
# Load Required Packages
require(ggplot2)
require(gridExtra)
options(scipen = 999)
#the function will make three plots, save them into objects and stack them together using gridExtra
#making the first plot
bar.pop <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=317309, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=317309, y="Population        ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$Pop, y="Population        "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(4700,max(x$Pop)+1000) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#second plot
bar.inc <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=55276, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=55276, y="Median Income", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$MHincome, y="Median Income"), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(34200,max(x$MHincome)+800) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#third plot
bar.pov <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_vline(xintercept=13.8, color = "grey80", size=4, linetype = "solid") +
geom_text(aes(x=13.8, y="Poverty Rate     ", label= "NY Average"), size = 3, colour = "grey40", angle = 90) +
geom_point(aes(x=x$pov.rate, y="Poverty Rate     "), stat="identity", shape = 23, size = 8) +
theme_minimal() +
xlim(5,max(x$pov.rate)+1) +
theme(legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(color = "grey80", fill= NA),
panel.border = element_blank(),
legend.title = element_blank(),
panel.grid = element_blank(),
#panel.grid.major.y = element_line(color = "grey80"),
#panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_line(color = "grey80"))
#panel.grid.minor.x = element_line(color = "grey80"))
#making a legend with a plot.
leg <- ggplot(x, aes(fill=county.name, color = county.name)) +
geom_point(aes(x=2:(length(levels(x$county.name))+1), y=""), stat="identity", shape = 23, size = 8) +
theme_minimal() +
coord_cartesian(xlim = 1:(length(levels(x$county.name))+2)) +
geom_text(aes(x=2:(length(levels(x$county.name))+1), y=.7, label = paste0(levels(x$county.name))),
size= 4,
hjust = .5,
vjust = .5,
colour = "grey20") +
labs(caption = "*Poverty Rate is a percentage; Median Income is by Household \n Source: ACS 2015 Census data.") +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
panel.grid=element_blank(),
panel.border = element_blank(),
legend.title = element_blank())
#compiling everything for output
bars <- grid.arrange(bar.pop, bar.inc, bar.pov, leg, nrow= 4, ncol=1, heights=c(1,1,1,1), widths=c(1))
return(bars)
}
krzycensuz(x)
knitr::opts_chunk$set( echo = T, message=F, warning=F, fig.width = 10, fig.height = 10 )
library(censusapi)
library(dplyr)
library(pander)
library(geojsonio)
library(sp) #need this to read the json shapes in gplot
#install.packages("MatchIt")
library(MatchIt)
setwd("C:/Users/icps/Dropbox/3. Maxwell/4. Capston")
#########################Loading DATASETS########################
############Grants DF##########
gra16 <- readRDS( gzcon(url("https://github.com/DataCapstone/Data-Capstone/blob/master/Raw-Data/NYgra16_counties_named.rds?raw=true")))
############Grants DF##########
NYcensus <- readRDS( gzcon(url("https://github.com/DataCapstone/Data-Capstone/blob/master/Raw-Data/NYcensus.rds?raw=true")))
dat <- NYcensus
#To run matchit we need to have a treatment and control group
#We flag one county as part of the treatment group and the 61 others are assumed as the control
county <- "Broome"
x <- dat$county.name == county
dat$Treat <- 0
dat$Treat[x] <- 1
#creating objects
mat.list <- rep(NA,5)
dis <- rep(FALSE, 62)
#pop density
for (i in c(1:5)) {
mat <- matchit(Treat ~  Pop + MHincome + pov.rate, data = dat, discard = dis)
x <- as.numeric(mat$match.matrix)
dis[x] <- TRUE
mat.list[i] <- x
}
x <- paste(1:5, ".", as.character(dat$county.name[mat.list]), ", ", sep = "", collapse = "")
x <- substr(x,1,nchar(x)-2)
x <- paste0("Matches for ", county, ": ", x)
print(x)
county <- "Onondaga"
x <- dat$county.name == county
dat$Treat <- 0
dat$Treat[x] <- 1
mat.list <- rep(NA,5)
dis <- rep(FALSE, 62)
for (i in c(1:5)) {
mat <- matchit(Treat ~  Pop + MHincome + pov.rate, data = dat, discard = dis)
x <- as.numeric(mat$match.matrix)
dis[x] <- TRUE
mat.list[i] <- x
}
x <- paste(1:5, ".", as.character(dat$county.name[mat.list]), ", ", sep = "", collapse = "")
x <- substr(x,1,nchar(x)-2)
x <- paste0("Matches for ", county, ": ", x)
print(x)
=======
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001)))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type,labeller = label_both)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text(size = 8, angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.spacing = unit(1, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(1, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), plot.margin = unit(c(.0001,.0001,.0001,.0001), "npc"))
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(1, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.5, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=y), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
agg.pop <- merge(agency.agg , pop.dat.state, by.x = "County", by.y = "county.name", all.x=TRUE)
agg.pop.percap <- mutate(agg.pop , percap =  Federal_Funding / Pop )
agg.pop.percap<- agg.pop.percap[order(agg.pop.percap$Agency), ]
# round percap to display better
agg.pop.percap %>% mutate(percap = round(percap, 2))
agg.pop <- merge(agency.agg , pop.dat.state, by.x = "County", by.y = "county.name", all.x=TRUE)
agg.pop.percap <- mutate(agg.pop , percap =  Federal_Funding / Pop )
agg.pop.percap<- agg.pop.percap[order(agg.pop.percap$Agency), ]
# round percap to display better
agg.pop.percap %>% mutate(percap = round(percap, 1))
county.filter <- filter(agg.pop.percap, County %in% c("Onondaga", "Erie"))
#counties.percap.ordered<- county.filter[order(county.filter$percap), ]
#selected<-counties.percap.ordered[unlist(tapply(row.names(counties.percap.ordered), counties.percap.ordered$County_Name, tail, n = 3)), ]
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
View(county.filter)
agg.pop <- merge(agency.agg , pop.dat.state, by.x = "County", by.y = "county.name", all.x=TRUE)
agg.pop.percap <- mutate(agg.pop , percap =  Federal_Funding / Pop )
agg.pop.percap<- agg.pop.percap[order(agg.pop.percap$Agency), ]
# round percap to display better
agg.pop.percap %>% mutate(percap = round(percap, 1))
county.filter <- filter(agg.pop.percap, County %in% c("Onondaga", "Erie"))
#counties.percap.ordered<- county.filter[order(county.filter$percap), ]
#selected<-counties.percap.ordered[unlist(tapply(row.names(counties.percap.ordered), counties.percap.ordered$County_Name, tail, n = 3)), ]
View(county.filter)
agg.pop <- merge(agency.agg , pop.dat.state, by.x = "County", by.y = "county.name", all.x=TRUE)
agg.pop.percap <- mutate(agg.pop , percap =  Federal_Funding / Pop )
agg.pop.percap<- agg.pop.percap[order(agg.pop.percap$Agency), ]
# round percap to display better
agg.pop.percap <- mutate(agg.pop.percap, percap = round(percap, 1))
county.filter <- filter(agg.pop.percap, County %in% c("Onondaga", "Erie"))
#counties.percap.ordered<- county.filter[order(county.filter$percap), ]
#selected<-counties.percap.ordered[unlist(tapply(row.names(counties.percap.ordered), counties.percap.ordered$County_Name, tail, n = 3)), ]
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap))+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type)+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 0), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by County, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by /nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),plot.margin = unit(c(.0001,.0001,.0001,.0001, .0001), "npc"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),plot.margin = unit(c(.0001,.0001,.0001,.0001, .0001), "npc"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+  geom_text(aes(label=percap), vjust=0)+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),plot.margin = unit(c(.00001,.00001,.00001,.00001, .00001), "npc"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(),   axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y", switch="x")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="right", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_tufte() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_classic() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_economist() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_economist_white() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_bw() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_light() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y", space="free_x"+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y", space="free_x")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y", space="free_y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
View(agg.pop.percap)
county.filter <- filter(agg.pop.percap, County %in% c("Onondaga", "Broome", "Oswego"))
#counties.percap.ordered<- county.filter[order(county.filter$percap), ]
#selected<-counties.percap.ordered[unlist(tapply(row.names(counties.percap.ordered), counties.percap.ordered$County_Name, tail, n = 3)), ]
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
ggplot(county.filter, aes(x=County, y= percap)) + geom_bar( aes(fill=County), stat="identity")  + facet_grid(Agency ~ Recipient_Type, switch="y")+
labs(title="Federal Project Grant Funding by \nCounty, Agency, and Recipient",
subtitle="Per Capita Funding, FY 2016")+ theme_minimal() + theme (strip.text.y = element_text( angle = 180), plot.title = element_text(size=16),legend.position="top", legend.title = element_blank(), axis.title.x=element_blank(), legend.key.size = unit(.5, "line"), panel.margin = unit(.25, "lines"),
axis.title.y= element_blank(), axis.ticks=element_blank(), axis.text.x= element_blank(),  axis.text.y= element_blank())
=======
names(gra16.2)
head(gra16.2$recipient_name)
# Download the data, clean
gra16.named <- readRDS(gzcon(url("https://github.com/DataCapstone/Data-Capstone/blob/master/Raw-Data/NYgra16_counties_named.rds?raw=true")))
#codes <- read.csv("https://raw.githubusercontent.com/DataCapstone/Data-Capstone/master/Raw-Data/countycodesNY.csv")
#exclude money going to state government and choose only project grants
gra16.without.state <- dplyr::filter( gra16.named , recipient_type != "00: State government" )
gra16.2 <- mutate(gra16.without.state, county = as.character(Name))
#note, changed from agency_name with 72 options to maj_agency_cat with 26!, also dropped columns I didn't need
gra16.3 <- gra16.2[ c("recip_cat_type", "county" , "fed_funding_amount" ,  "maj_agency_cat", "assistance_type", "recipient_name" ) ]
x <- gra16.3$recip_cat_type == "i: Private agencies"
gra16.3$recip_cat_type[x] <- "f: Private agencies"
y <- gra16.3$recip_cat_type == "h: Government"
gra16.3$recip_cat_type[y] <- "h: Private agencies"
#making recip_cat_type into a factor and changing the levels into more friendly ones
gra16.3$recip_cat_type <- factor(x= gra16.3$recip_cat_type)
levels(gra16.3$recip_cat_type) <- c("Private firms",
"Government",
"Higher Ed",
"Nonprofit agencies",
"Other")
# clean agency names a bit to be more consistent
simpleCap <- function(x) {
s <- tolower(x)
s <- strsplit(s, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
gra16.3$maj_agency_cat <-sapply(gra16.3$maj_agency_cat, simpleCap)
gra16.3$maj_agency_cat<-gsub( "Department Of ", "", as.character(gra16.3$maj_agency_cat), n)
gra16.3$maj_agency_cat<-(substring(gra16.3$maj_agency_cat, 7, nchar(gra16.3$maj_agency_cat)))
head(gra16.3$recipient_name)
head(gra16.3)
hmm <- aggregate(gra16.3, by= list(gra16.3$recipient_name, gra16.3$county))
hmm <- aggregate(gra16.3, by= list(gra16.3$recipient_name, gra16.3$county), FUN = sum)
class(gra16.3$recipient_name)
class(gra16.3$county)
hmm <- aggregate(gra16.3$fed_funding_amount, by= list(gra16.3$recipient_name, gra16.3$county), FUN = sum)
head(hmm)
top.rec <- aggregate(gra16.3$fed_funding_amount, by= list(gra16.3$recipient_name, gra16.3$county), FUN = sum)
top.rec.2 <- filter(top.rec , Group.2 == "Onondaga")
top.rec.3 <- arrange(top.rec.2 , desc(x))
top <- top.rec.3[1,
]
top
top <- top.rec.3[1,]$Group.1
top
>>>>>>> 643f0f43e6f115a54e7fd2d6095169c340864e95
library(shiny); runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
install.packages("rsconnect")
rsconnect::setAccountInfo(name='usaspending-explorer', token='88457DFE06463D0C20FCE938C2C5B830', secret='M6/WoD/Fm/Q2rwaQIvnT6JslaeWL/s3zeQaVHvTY')
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(shiny)
# Download the data, clean
gra16.named <- readRDS(gzcon(url("https://github.com/DataCapstone/Data-Capstone/blob/master/Raw-Data/NYgra16_counties_named.rds?raw=true")))
#exclude money going to state government and choose only project grants
gra16.without.state <- dplyr::filter( gra16.named , recipient_type != "00: State government" )
gra16.2 <- mutate(gra16.without.state, county = as.character(Name))
#note, changed from agency_name with 72 options to maj_agency_cat with 26!, also dropped columns I didn't need
gra16.3 <- gra16.2[ c("recip_cat_type", "county" , "fed_funding_amount" ,  "maj_agency_cat", "assistance_type" ) ]
x <- gra16.3$recip_cat_type == "i: Private agencies"
gra16.3$recip_cat_type[x] <- "f: Private agencies"
y <- gra16.3$recip_cat_type == "h: Government"
gra16.3$recip_cat_type[y] <- "h: Private agencies"
#making recip_cat_type into a factor and changing the levels into more friendly ones
gra16.3$recip_cat_type <- factor(x= gra16.3$recip_cat_type)
levels(gra16.3$recip_cat_type) <- c("Private Firm",
"Government",
"Higher Ed",
"Nonprofit",
"Other")
# clean agency names a bit to be more consistent
simpleCap <- function(x) {
s <- tolower(x)
s <- strsplit(s, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
gra16.3$maj_agency_cat <-sapply(gra16.3$maj_agency_cat, simpleCap)
gra16.3$maj_agency_cat<-gsub( "Department Of ", "", as.character(gra16.3$maj_agency_cat), n)
gra16.3$maj_agency_cat<-(substring(gra16.3$maj_agency_cat, 7, nchar(gra16.3$maj_agency_cat)))
head(gra16.3)
gra16.2 <- mutate(gra16.without.state, county = as.character(Name))
#note, changed from agency_name with 72 options to maj_agency_cat with 26!, also dropped columns I didn't need
gra16.3 <- gra16.2[ c("recip_cat_type", "county" , "fed_funding_amount" ,  "maj_agency_cat", "assistance_type" , "recipient_name") ]
x <- gra16.3$recip_cat_type == "i: Private agencies"
gra16.3$recip_cat_type[x] <- "f: Private agencies"
y <- gra16.3$recip_cat_type == "h: Government"
gra16.3$recip_cat_type[y] <- "h: Private agencies"
#making recip_cat_type into a factor and changing the levels into more friendly ones
gra16.3$recip_cat_type <- factor(x= gra16.3$recip_cat_type)
levels(gra16.3$recip_cat_type) <- c("Private Firm",
"Government",
"Higher Ed",
"Nonprofit",
"Other")
# clean agency names a bit to be more consistent
simpleCap <- function(x) {
s <- tolower(x)
s <- strsplit(s, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
gra16.3$maj_agency_cat <-sapply(gra16.3$maj_agency_cat, simpleCap)
gra16.3$maj_agency_cat<-gsub( "Department Of ", "", as.character(gra16.3$maj_agency_cat), n)
gra16.3$maj_agency_cat<-(substring(gra16.3$maj_agency_cat, 7, nchar(gra16.3$maj_agency_cat)))
head(gra16.3)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
# Download the data, clean
gra16.named <- readRDS(gzcon(url("https://github.com/DataCapstone/Data-Capstone/blob/master/Raw-Data/NYgra16_counties_named.rds?raw=true")))
#exclude money going to state government and choose only project grants
gra16.without.state <- dplyr::filter( gra16.named , recipient_type != "00: State government" )
gra16.2 <- mutate(gra16.without.state, county = as.character(Name))
#note, changed from agency_name with 72 options to maj_agency_cat with 26!, also dropped columns I didn't need
gra16.3 <- gra16.2[ c("recip_cat_type", "county" , "fed_funding_amount" ,  "maj_agency_cat", "assistance_type" , "recipient_name", "cfda_program_title") ]
x <- gra16.3$recip_cat_type == "i: Private agencies"
gra16.3$recip_cat_type[x] <- "f: Private agencies"
y <- gra16.3$recip_cat_type == "h: Government"
gra16.3$recip_cat_type[y] <- "h: Private agencies"
#making recip_cat_type into a factor and changing the levels into more friendly ones
gra16.3$recip_cat_type <- factor(x= gra16.3$recip_cat_type)
levels(gra16.3$recip_cat_type) <- c("Private Firm",
"Government",
"Higher Ed",
"Nonprofit",
"Other")
# clean agency names a bit to be more consistent
simpleCap <- function(x) {
s <- tolower(x)
s <- strsplit(s, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
gra16.3$maj_agency_cat <-sapply(gra16.3$maj_agency_cat, simpleCap)
gra16.3$maj_agency_cat<-gsub( "Department Of ", "", as.character(gra16.3$maj_agency_cat), n)
gra16.3$maj_agency_cat<-(substring(gra16.3$maj_agency_cat, 7, nchar(gra16.3$maj_agency_cat)))
saveRDS(gra16.3, "columns_selected.3")
head(gra16.3)
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
gra16.4 <- filter(gra16.3 , county %in% input$your_county , assistance_type == "04: Project grant", fed_funding_amount > 0)
gra16.4 <- filter(gra16.3 , county %in% c("Onondaga") , assistance_type == "04: Project grant", fed_funding_amount > 0)
head(gra16.4)
gra16.3
gra16.3_url <- "https://github.com/DataCapstone/Data-Capstone/blob/master/columns_selected.3?raw=true"
gra16.3 <- readRDS( gzcon( url( gra16.3_url )))
View(gra16.3)
co_url <- "https://raw.githubusercontent.com/DataCapstone/Data-Capstone/master/Raw-Data/county_comparison_2.R"
source_github(co_url)
source_github <- function( url ) {
# load package
require(RCurl)
# read script lines from website and evaluate
script <- getURL(url, ssl.verifypeer = FALSE)
eval(parse(text = script), envir=.GlobalEnv)
}
co_url <- "https://raw.githubusercontent.com/DataCapstone/Data-Capstone/master/Raw-Data/county_comparison_2.R"
source_github(co_url)
head(gra16.3)
gra16.4 <- filter(gra16.3 , county == "Onondaga" , assistance_type == "04: Project grant", fed_funding_amount > 0)
view(gra16.4)
View(gra16.4)
View(gra16.4)
runApp('Stephanie/sankey shiny sankify with all.R')
runApp('Stephanie/sankey shiny sankify with all.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
gra16.4 <- filter(gra16.3 , county %in% input$your_county )
gra16.4 <- filter(gra16.3 , county %in% c("Onondaga", "Madison"))
pop.filtered <- filter(population , county.name %in% c("Onondaga", "Madison") )
gra16.4.2 <- mutate(gra16.4 , assistance_type.2 = ifelse( assistance_type == "04: Project grant", "Project Grants" , "Other Grants" ) )
gra16.agg <- agg.county.percap(gra16.4.2 , pop.filtered, gra16.4.2$assistance_type.2) #Function
colnames(gra16.agg)[1] <- "assistance_type.2"
gra16.agg.2 <- gra16.agg[c("assistance_type.2", "fund", "percap", "county")]
gra16.agg.3 <- rbind(gra16.agg.2 , ny.per.2)
cols <- c("#00CCFF","#3333FF")
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
cols <- c("#F67670","#EBEBEB")
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
cols <- c("#EBEBEB", "#F67670")
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
cols <- c("#EBEBEB", "#1BB841")
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
cols <- c("#EBEBEB", "#649EFC")
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
ggplot(gra16.agg.3, aes(x = county, y = percap, fill = assistance_type.2)) +
geom_bar(stat = "identity") +
labs(x="County", y="Per Capita Funding") +
# ggtitle("Per Capita Federal Funding by County") +
scale_y_continuous(labels = scales::dollar_format(prefix="$", big.mark = ",")) +
scale_fill_manual(values = cols) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_blank() , legend.title = element_blank())
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
runApp('Raw-Data/example_shinyapp_2.R')
print(source('Raw-Data/example_shinyapp_2.R')$value)
print(source('Raw-Data/example_shinyapp_2.R')$value)
print(source('Raw-Data/example_shinyapp_2.R')$value)
runApp('Raw-Data/example_shinyapp_2.R')
print(source('Raw-Data/example_shinyapp_2.R')$value)
print(source('Raw-Data/example_shinyapp_2.R')$value)
print(source('Raw-Data/example_shinyapp_2.R')$value)
print(source('Raw-Data/example_shinyapp_2.R')$value)
>>>>>>> 4286bff81dc546aa6098ab0cd8626187c6374cbc
